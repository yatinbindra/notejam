[2023-11-29 07:01:54,432] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-11-29 07:01:54,452] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-11-29 07:01:54,453] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-11-29 07:01:54,454] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-11-29 07:06:54,459] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-11-29 07:06:54,460] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-11-29 07:06:54,463] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-11-29 07:06:54,463] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-11-29 07:11:54,590] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-11-29 07:11:54,789] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-11-29 07:11:55,228] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-11-29 07:11:55,379] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-11-29 07:16:56,252] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-11-29 07:16:56,374] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-11-29 07:16:56,445] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-11-29 07:16:56,603] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-11-29 07:22:08,805] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-11-29 07:22:08,872] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-11-29 07:22:13,513] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-11-29 07:22:13,708] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-11-29 07:24:20,680] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2023-11-29 07:24:30,110] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2023-11-29 07:24:53,102] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2023-11-29 07:25:38,966] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2023-11-29 07:25:57,701] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2023-11-29 07:26:02,134] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2023-11-29 07:26:02,150] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2023-11-29 07:32:04,402] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2023-11-29 07:32:23,515] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2023-11-29 07:32:25,417] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2023-11-29 07:32:25,653] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2023-11-29 07:32:27,965] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2023-11-29 07:32:28,317] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2023-11-29 07:36:01,726] ERROR [Controller id=0] Error while electing or becoming controller on broker 0. Trigger controller movement immediately (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at kafka.zk.KafkaZkClient.tryCreateControllerZNodeAndIncrementEpoch$1(KafkaZkClient.scala:162)
	at kafka.zk.KafkaZkClient.registerControllerAndIncrementControllerEpoch(KafkaZkClient.scala:166)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2539)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2544)
	at kafka.controller.KafkaController.process(KafkaController.scala:2586)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:127)
[2023-11-29 07:36:35,810] ERROR [Controller id=0] Error processing event RegisterBrokerAndReelect (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /controller
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at kafka.zookeeper.AsyncResponse.resultException(ZooKeeperClient.scala:563)
	at kafka.zk.KafkaZkClient.getControllerId(KafkaZkClient.scala:1226)
	at kafka.controller.KafkaController.triggerControllerMove(KafkaController.scala:1482)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1540)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2539)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2544)
	at kafka.controller.KafkaController.process(KafkaController.scala:2586)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:127)
[2023-11-29 07:36:38,519] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2023-11-29 07:36:38,800] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2023-11-29 07:36:38,872] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2023-11-29 07:36:39,403] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2023-11-29 07:36:39,815] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
